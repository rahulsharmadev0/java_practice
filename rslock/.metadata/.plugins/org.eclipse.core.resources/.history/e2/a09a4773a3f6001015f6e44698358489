package com.rslock.encryptor;

import java.io.InputStream;
import java.io.OutputStream;
import java.nio.file.Files;
import java.util.concurrent.Executor;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import javax.crypto.CipherInputStream;
import javax.crypto.CipherOutputStream;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;

import com.rslock.common.CypherUtility;
import com.rslock.common.RsCommandLineArgs;

public class RsfileEncryptor {

	public static void main(String[] args) throws Exception{
    	RsCommandLineArgs cmdArgs = RsCommandLineArgs.parse(args);
    	
    	int POOL_SIZE = Math.min(4, cmdArgs.getSourceFiles().size());
    	
    	ExecutorService threadPool = Executors.newFixedThreadPool(POOL_SIZE);
        
        SecretKey  key = CypherUtility.generateAESKey();
        IvParameterSpec iv = CypherUtility.generateIV();
        
       
        InputStream in = Files.newInputStream(cmdArgs.getSourceFiles().getFirst());
        
        CipherInputStream cipherInputStream =  CypherUtility.decryptStream(in,key, iv);
        
        
        OutputStream out = Files.newOutputStream(cmdArgs.getDestinationDir());
        
        CipherOutputStream cipherOutputStream =  CypherUtility.encryptStream(in,key, iv);
        
        
        
        
        		

    }

}
